2016-09-30  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Stepping to a line with an autoContinue breakpoint should still pause
        https://bugs.webkit.org/show_bug.cgi?id=161712
        <rdar://problem/28193970>

        Reviewed by Brian Burg.

        * inspector/debugger/stepping/stepping-through-autoContinue-breakpoint-expected.txt: Added.
        * inspector/debugger/stepping/stepping-through-autoContinue-breakpoint.html: Added.

2016-09-30  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Stepping over/out of a function sometimes resumes instead of taking you to caller
        https://bugs.webkit.org/show_bug.cgi?id=162802
        <rdar://problem/28569982>

        Reviewed by Mark Lam.

        * inspector/debugger/resources/log-pause-location.js:
        (TestPage.registerInitializer.createLocation):
        (TestPage.registerInitializer.window.setBreakpointsOnLinesWithBreakpointComment):
        Helper to set breakpoints everywhere in a file that has a BREAKPOINT comment.

        * inspector/debugger/stepping/stepping-pause-in-inner-step-to-parent-expected.txt: Added.
        * inspector/debugger/stepping/stepping-pause-in-inner-step-to-parent.html: Added.
        Test that stepping out and over end up in the parent. Before this change
        we would never have made it back into entry and the test failed.

2016-09-30  Myles C. Maxfield  <mmaxfield@apple.com>

        Implement rendering of font-variation-settings
        https://bugs.webkit.org/show_bug.cgi?id=162782

        Reviewed by Zalan Bujtas.

        * fast/text/variations/duplicate-expected.html: Added.
        * fast/text/variations/duplicate.html: Added.
        * fast/text/variations/exist-expected-mismatch.html: Added.
        * fast/text/variations/exist.html: Added.
        * fast/text/variations/getComputedStyle.html:
        * fast/text/variations/inheritance-expected.html: Added.
        * fast/text/variations/inheritance.html: Added.
        * fast/text/variations/order-expected.html: Added.
        * fast/text/variations/order.html: Added.
        * fast/text/variations/outofbounds-expected.html: Added.
        * fast/text/variations/outofbounds.html: Added.

2016-09-30  Myles C. Maxfield  <mmaxfield@apple.com>

        Implement animation of font-variation-settings
        https://bugs.webkit.org/show_bug.cgi?id=162783

        Reviewed by Simon Fraser.

        Animation tests need a little infrastructure to be able to tell if two computed
        values for font-variation-settings are equivalent.

        * animations/font-variation-settings-expected.html: Added.
        * animations/font-variation-settings-order-expected.html: Added.
        * animations/font-variation-settings-order.html: Added.
        * animations/font-variation-settings-unlike-expected.html: Added.
        * animations/font-variation-settings-unlike.html: Added.
        * animations/font-variation-settings.html: Added.
        * animations/resources/animation-test-helpers.js:
        (compareFontVariationSettings):
        (getPropertyValue):
        (comparePropertyValue):

2016-09-30  Antoine Quint  <graouts@apple.com>

        [Modern Media Controls] layout nodes
        https://bugs.webkit.org/show_bug.cgi?id=162799
        <rdar://problem/28569301>

        Reviewed by Dean Jackson.

        Testing all public properties and methods of the LayoutNode class.

        * media/modern-media-controls/layout-node/addChild-expected.txt: Added.
        * media/modern-media-controls/layout-node/addChild.html: Added.
        * media/modern-media-controls/layout-node/children-expected.txt: Added.
        * media/modern-media-controls/layout-node/children.html: Added.
        * media/modern-media-controls/layout-node/constructor-expected.txt: Added.
        * media/modern-media-controls/layout-node/constructor.html: Added.
        * media/modern-media-controls/layout-node/height-expected.txt: Added.
        * media/modern-media-controls/layout-node/height.html: Added.
        * media/modern-media-controls/layout-node/insertAfter-expected.txt: Added.
        * media/modern-media-controls/layout-node/insertAfter.html: Added.
        * media/modern-media-controls/layout-node/insertBefore-expected.txt: Added.
        * media/modern-media-controls/layout-node/insertBefore.html: Added.
        * media/modern-media-controls/layout-node/parent-expected.txt: Added.
        * media/modern-media-controls/layout-node/parent.html: Added.
        * media/modern-media-controls/layout-node/remove-expected.txt: Added.
        * media/modern-media-controls/layout-node/remove.html: Added.
        * media/modern-media-controls/layout-node/removeChild-expected.txt: Added.
        * media/modern-media-controls/layout-node/removeChild.html: Added.
        * media/modern-media-controls/layout-node/subclassing-expected.txt: Added.
        * media/modern-media-controls/layout-node/subclassing.html: Added.
        * media/modern-media-controls/layout-node/visible-expected.txt: Added.
        * media/modern-media-controls/layout-node/visible.html: Added.
        * media/modern-media-controls/layout-node/width-expected.txt: Added.
        * media/modern-media-controls/layout-node/width.html: Added.
        * media/modern-media-controls/layout-node/x-expected.txt: Added.
        * media/modern-media-controls/layout-node/x.html: Added.
        * media/modern-media-controls/layout-node/y-expected.txt: Added.
        * media/modern-media-controls/layout-node/y.html: Added.

2016-09-30  Ryan Haddad  <ryanhaddad@apple.com>

        Marking http/tests/media/hls/hls-video-resize.html as flaky on mac-wk1.
        https://bugs.webkit.org/show_bug.cgi?id=162507

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2016-09-30  Myles C. Maxfield  <mmaxfield@apple.com>

        Parse font-variation-settings
        https://bugs.webkit.org/show_bug.cgi?id=162781

        Reviewed by Simon Fraser.

        * fast/text/variations/getComputedStyle-expected.txt: Added.
        * fast/text/variations/getComputedStyle.html: Added.

2016-09-30  Ryan Haddad  <ryanhaddad@apple.com>

        Mark inspector/debugger/breakpoints tests as slow on release, skipped on debug.

        Unreviewed test gardening.

        * TestExpectations:

2016-09-30  Joseph Pecoraro  <pecoraro@apple.com>

        Rebaseline results after r206654.

        Better location for unary expressions.

        * js/stack-trace-expected.txt:

2016-09-30  Myles C. Maxfield  <mmaxfield@apple.com>

        Fix fast/text/trak-optimizeLegibility.html
        https://bugs.webkit.org/show_bug.cgi?id=162779

        Reviewed by Simon Fraser.

        * fast/text/trak-optimizeLegibility.html:
        * platform/ios-simulator/fast/text/trak-optimizeLegibility-expected.txt:
        * platform/mac-elcapitan/fast/text/trak-optimizeLegibility-expected.txt: Removed.
        * platform/mac/fast/text/trak-optimizeLegibility-expected.txt:

2016-09-30  Zalan Bujtas  <zalan@apple.com>

        Unreviewed, rolling out r206611.

        Scroll perf did not recover.

        Reverted changeset:

        "Unreviewed, rolling out r206483."
        https://bugs.webkit.org/show_bug.cgi?id=162750
        http://trac.webkit.org/changeset/206611

2016-09-30  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline js/dom/stack-trace.html after r206654.

        Unreviewed test gardening.

        * js/dom/stack-trace-expected.txt:

2016-09-30  Chris Dumez  <cdumez@apple.com>

        FileSaver.js does not work in WebKit
        https://bugs.webkit.org/show_bug.cgi?id=162788

        Reviewed by Sam Weinig.

        Add layout test coverage.

        * fast/dom/HTMLAnchorElement/anchor-download-synthetic-click-expected.txt:
        * fast/dom/HTMLAnchorElement/anchor-download-user-triggered-synthetic-click-expected.txt: Added.
        * fast/dom/HTMLAnchorElement/anchor-download-user-triggered-synthetic-click.html: Added.

2016-09-30  Ryan Haddad  <ryanhaddad@apple.com>

        Marking fast/images/gif-loop-count.html as flaky on ios-simulator.
        https://bugs.webkit.org/show_bug.cgi?id=162739

        Unreviewed test gardening.

        * platform/ios-simulator-wk1/TestExpectations:
        * platform/ios-simulator/TestExpectations:

2016-09-30  Ryan Haddad  <ryanhaddad@apple.com>

        Marking http/tests/security/cached-cross-origin-preloading-css-stylesheet.html as flaky on mac-wk1.
        https://bugs.webkit.org/show_bug.cgi?id=162791

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2016-09-28  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Stepping through `a(); b(); c();` it is unclear where we are and what is about to execute
        https://bugs.webkit.org/show_bug.cgi?id=161658
        <rdar://problem/28181254>

        Reviewed by Geoffrey Garen.

        * inspector/debugger/stepping/stepping-loops-expected.txt:
        * inspector/debugger/stepping/stepping-misc-expected.txt:
        Updated pause location for unary expressions.

2016-09-30  Joseph Pecoraro  <pecoraro@apple.com>

        Breakpoints on blank lines or comments don't break
        https://bugs.webkit.org/show_bug.cgi?id=9885
        <rdar://problem/6134406>

        Reviewed by Mark Lam.

        * inspector/debugger/breakpoints/resolved-dump-all-pause-locations-expected.txt: Added.
        * inspector/debugger/breakpoints/resolved-dump-all-pause-locations.html: Added.
        * inspector/debugger/breakpoints/resolved-dump-each-line-expected.txt: Added.
        * inspector/debugger/breakpoints/resolved-dump-each-line.html: Added.
        * inspector/debugger/breakpoints/resources/dump-functions.js: Added.
        * inspector/debugger/breakpoints/resources/dump-general.js: Added.
        Test for resolved breakpoint locations in all kinds of different source code.

        * inspector/debugger/breakpoints/resources/dump.js: Added.
        (TestPage.registerInitializer):
        (TestPage.registerInitializer.window.addDumpAllPauseLocationsTestCase):
        (TestPage.registerInitializer.window.addDumpEachLinePauseLocationTestCase):
        Shared code to run different generalized tests for logging all resolved
        breakpoint locations or the resolved breakpoint location if a breakpoint
        is set on each individual line.

        * inspector/debugger/resources/log-pause-location.js:
        (TestPage.registerInitializer.insertCaretIntoStringAtIndex):
        (TestPage.registerInitializer.window.findScript):
        (TestPage.registerInitializer.window.loadLinesFromSourceCode):
        (TestPage.registerInitializer.window.loadMainPageContent):
        (TestPage.registerInitializer.window.logResolvedBreakpointLinesWithContext):
        (TestPage.registerInitializer.window.logLinesWithContext):
        Make some more code shared and provide a way to log two locations,
        used to see where a breakpoint was set and where it resolved to.

        * inspector/debugger/setBreakpoint-expected.txt:
        Update error message. Should not include a period.

2016-09-30  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Stepping out of a function finishes the line that called it.
        https://bugs.webkit.org/show_bug.cgi?id=155325
        <rdar://problem/25094578>

        Reviewed by Mark Lam.

        * inspector/debugger/break-on-exception-throw-in-promise.html:
        Drive-by remove debug only code that shouldn't have been checked in.

        * inspector/debugger/resources/log-pause-location.js: Added.
        (TestPage.registerInitializer.String.prototype.myPadStart):
        (TestPage.registerInitializer.insertCaretIntoStringAtIndex):
        (TestPage.registerInitializer.logLinesWithContext):
        (TestPage.registerInitializer.window.logPauseLocation):
        (TestPage.registerInitializer.window.step):
        (TestPage.registerInitializer.window.initializeSteppingTestSuite):
        (TestPage.registerInitializer.window.addSteppingTestCase):
        (TestPage.registerInitializer.window.loadMainPageContent):
        Shared code for stepping tests that runs in the inspected page.

        (global):
        When the test page is loaded outside of the test runner,
        create buttons for each of the different entry test functions.
        This makes it very easy to inspect the test page and run
        through an individual test.

        * inspector/debugger/stepping/stepInto-expected.txt: Added.
        * inspector/debugger/stepping/stepInto.html: Added.
        * inspector/debugger/stepping/stepOut-expected.txt: Added.
        * inspector/debugger/stepping/stepOut.html: Added.
        * inspector/debugger/stepping/stepOver-expected.txt: Added.
        * inspector/debugger/stepping/stepOver.html: Added.
        * inspector/debugger/stepping/stepping-arrow-functions-expected.txt: Added.
        * inspector/debugger/stepping/stepping-arrow-functions.html: Added.
        * inspector/debugger/stepping/stepping-classes-expected.txt: Added.
        * inspector/debugger/stepping/stepping-classes.html: Added.
        * inspector/debugger/stepping/stepping-control-flow-expected.txt: Added.
        * inspector/debugger/stepping/stepping-control-flow.html: Added.
        * inspector/debugger/stepping/stepping-function-calls-expected.txt: Added.
        * inspector/debugger/stepping/stepping-function-calls.html: Added.
        * inspector/debugger/stepping/stepping-function-default-parameters-expected.txt: Added.
        * inspector/debugger/stepping/stepping-function-default-parameters.html: Added.
        * inspector/debugger/stepping/stepping-literal-construction-expected.txt: Added.
        * inspector/debugger/stepping/stepping-literal-construction.html: Added.
        * inspector/debugger/stepping/stepping-loops-expected.txt: Added.
        * inspector/debugger/stepping/stepping-loops.html: Added.
        * inspector/debugger/stepping/stepping-misc-expected.txt: Added.
        * inspector/debugger/stepping/stepping-misc.html: Added.
        * inspector/debugger/stepping/stepping-switch-expected.txt: Added.
        * inspector/debugger/stepping/stepping-switch.html: Added.
        * inspector/debugger/stepping/stepping-template-string-expected.txt: Added.
        * inspector/debugger/stepping/stepping-template-string.html: Added.
        * inspector/debugger/stepping/stepping-try-catch-finally-expected.txt: Added.
        * inspector/debugger/stepping/stepping-try-catch-finally.html: Added.
        Test stepping in different common scenarios.

        * inspector/debugger/regress-133182.html:
        * inspector/debugger/regress-133182-expected.txt:
        * inspector/debugger/tail-deleted-frames-from-vm-entry-expected.txt:
        * inspector/debugger/tail-deleted-frames-from-vm-entry.html:
        Rebaseline. No need for a double step. And the second pause doesn't make any sense
        in the tail deleted frames test.

2016-09-30  Chris Dumez  <cdumez@apple.com>

        [WK2][iOS] Add radiusX / radiusY / rotationAngle to WebPlatformTouchPoint
        https://bugs.webkit.org/show_bug.cgi?id=162787
        <rdar://problem/28554292>

        Reviewed by Benjamin Poulain.

        Extend Touch constructor test coverage to cover radiusX / radiusY / rotationAngle
        attributes.

        * fast/events/touch/touch-constructor.html:

2016-09-30  Saam Barati  <sbarati@apple.com>

        Arrow functions should not allow duplicate parameter names
        https://bugs.webkit.org/show_bug.cgi?id=162741

        Reviewed by Filip Pizlo.

        * js/parser-syntax-check-expected.txt:
        * js/script-tests/parser-syntax-check.js:

2016-09-30  Megan Gardner  <megan_gardner@apple.com>

        Make it possible to test web-related user-interface features
        https://bugs.webkit.org/show_bug.cgi?id=162657

        Reviewed by Simon Fraser.

        * fast/events/touch/ios/long-press-on-image-expected.txt: Added.
        * fast/events/touch/ios/long-press-on-image.html: Added.

2016-09-30  Said Abou-Hallawa  <sabouhallawa@apple.com>

        Change the MemoryCache and CachedResource adjustSize functions to take a long argument
        https://bugs.webkit.org/show_bug.cgi?id=162708
        <rdar://problem/28555702>

        Reviewed by Brent Fulgham.

        * TestExpectations: Remove failed tests.

2016-09-30  Chris Dumez  <cdumez@apple.com>

        Add support for ImageData.data attribute
        https://bugs.webkit.org/show_bug.cgi?id=162767

        Reviewed by Sam Weinig.

        Add layout test coverage.

        * fast/canvas/canvas-imageData-expected.txt:
        * fast/canvas/script-tests/canvas-imageData.js:

2016-09-30  Youenn Fablet  <youenn@apple.com>

        DumpRenderTree crashed in com.apple.WebCore: WTF::Optional<WebCore::FetchBodyOwner::BlobLoader>::operator bool const + 12
        https://bugs.webkit.org/show_bug.cgi?id=162483

        Reviewed by Alex Christensen.

        * fetch/closing-while-fetching-blob-expected.txt: Added.
        * fetch/closing-while-fetching-blob.html: Added.

2016-09-29  Chris Dumez  <cdumez@apple.com>

        Add support for download attribute on area elements
        https://bugs.webkit.org/show_bug.cgi?id=162765

        Reviewed by Brent Fulgham.

        Add layout test coverage.

        * http/tests/download/area-download-expected.txt: Added.
        * http/tests/download/area-download.html: Added.
        * http/tests/download/resources/FAIL-notify-done.html: Added.

2016-09-29  Jiewen Tan  <jiewen_tan@apple.com>

        Expose CryptoKey to web workers
        https://bugs.webkit.org/show_bug.cgi?id=162640
        <rdar://problem/28182204>

        Reviewed by Brent Fulgham.

        * crypto/resources/common.js: Renamed from LayoutTests/crypto/subtle/resources/common.js.
        * crypto/subtle/aes-cbc-192-encrypt-decrypt.html:
        * crypto/subtle/aes-cbc-256-encrypt-decrypt.html:
        * crypto/subtle/aes-cbc-encrypt-decrypt-with-padding.html:
        * crypto/subtle/aes-cbc-encrypt-decrypt.html:
        * crypto/subtle/aes-cbc-generate-key.html:
        * crypto/subtle/aes-cbc-import-jwk.html:
        * crypto/subtle/aes-cbc-invalid-length.html:
        * crypto/subtle/aes-cbc-unwrap-failure.html:
        * crypto/subtle/aes-cbc-unwrap-rsa.html:
        * crypto/subtle/aes-cbc-wrap-rsa-non-extractable.html:
        * crypto/subtle/aes-cbc-wrap-rsa.html:
        * crypto/subtle/aes-cbc-wrong-key-class.html:
        * crypto/subtle/aes-export-key.html:
        * crypto/subtle/aes-kw-key-manipulation.html:
        * crypto/subtle/aes-kw-wrap-unwrap-aes.html:
        * crypto/subtle/aes-postMessage-expected.txt:
        * crypto/subtle/aes-postMessage.html:
        * crypto/subtle/argument-conversion.html:
        * crypto/subtle/array-buffer-view-offset.html:
        * crypto/subtle/crypto-key-algorithm-gc.html:
        * crypto/subtle/crypto-key-usages-gc.html:
        * crypto/subtle/hmac-check-algorithm.html:
        * crypto/subtle/hmac-export-key.html:
        * crypto/subtle/hmac-generate-key.html:
        * crypto/subtle/hmac-import-jwk.html:
        * crypto/subtle/hmac-postMessage-expected.txt:
        * crypto/subtle/hmac-postMessage.html:
        * crypto/subtle/hmac-sign-verify-empty-key.html:
        * crypto/subtle/hmac-sign-verify.html:
        * crypto/subtle/import-jwk.html:
        * crypto/subtle/jwk-export-use-values.html:
        * crypto/subtle/jwk-import-use-values.html:
        * crypto/subtle/postMessage-worker-expected.txt: Removed.
        * crypto/subtle/rsa-export-generated-keys.html:
        * crypto/subtle/rsa-export-key.html:
        * crypto/subtle/rsa-export-private-key.html:
        * crypto/subtle/rsa-indexeddb-non-exportable-private.html:
        * crypto/subtle/rsa-indexeddb-non-exportable.html:
        * crypto/subtle/rsa-indexeddb-private.html:
        * crypto/subtle/rsa-indexeddb.html:
        * crypto/subtle/rsa-oaep-generate-non-extractable-key.html:
        * crypto/subtle/rsa-oaep-key-manipulation.html:
        * crypto/subtle/rsa-oaep-plaintext-length.html:
        * crypto/subtle/rsa-oaep-wrap-unwrap-aes.html:
        * crypto/subtle/rsa-postMessage.html:
        * crypto/subtle/rsaes-pkcs1-v1_5-decrypt.html:
        * crypto/subtle/rsaes-pkcs1-v1_5-wrap-unwrap-aes.html:
        * crypto/subtle/rsassa-pkcs1-v1_5-generate-key-with-leading-zeroes-in-exponent.html:
        * crypto/subtle/rsassa-pkcs1-v1_5-generate-key.html:
        * crypto/subtle/rsassa-pkcs1-v1_5-import-jwk-small-key.html:
        * crypto/subtle/rsassa-pkcs1-v1_5-import-jwk.html:
        * crypto/subtle/rsassa-pkcs1-v1_5-sign-verify.html:
        * crypto/subtle/sha-1.html:
        * crypto/subtle/sha-224.html:
        * crypto/subtle/sha-256.html:
        * crypto/subtle/sha-384.html:
        * crypto/subtle/sha-512.html:
        * crypto/subtle/unimplemented-unwrap-crash.html:
        * crypto/subtle/unwrapKey-check-usage.html:
        * crypto/subtle/wrapKey-check-usage.html:
        * crypto/workers/aes-postMessage-worker-expected.txt: Added.
        * crypto/workers/aes-postMessage-worker.html: Added.
        * crypto/workers/hmac-postMessage-worker-expected.txt: Added.
        * crypto/workers/hmac-postMessage-worker.html: Renamed from LayoutTests/crypto/subtle/postMessage-worker.html.
        * crypto/workers/hrsa-postMessage-worker-expected.txt: Added.
        * crypto/workers/hrsa-postMessage-worker.html: Added.
        * crypto/workers/multiple-postMessage-worker-expected.txt: Added.
        * crypto/workers/multiple-postMessage-worker.html: Added.
        * crypto/workers/resources/aes-postMessage-worker.js: Added.
        * crypto/workers/resources/hmac-postMessage-worker.js: Renamed from LayoutTests/crypto/subtle/resources/postMessage-worker.js.
        * crypto/workers/resources/hrsa-postMessage-worker.js: Added.
        * crypto/workers/resources/rsa-postMessage-worker.js: Added.
        * crypto/workers/rsa-postMessage-worker-expected.txt: Added.
        * crypto/workers/rsa-postMessage-worker.html: Added.
        * js/dom/global-constructors-attributes-dedicated-worker-expected.txt:

2016-09-29  Nan Wang  <n_wang@apple.com>

        AX: iOS: Tapping <input> in Safari zooms in a bit when page has max scale = 1
        https://bugs.webkit.org/show_bug.cgi?id=162471

        Reviewed by Simon Fraser.

        Moved focus input related tests to the right place.

        * fast/forms/ios/user-scalable-does-not-scale-for-keyboard-focus-with-author-defined-scale-expected.txt: Added.
        * fast/forms/ios/user-scalable-does-not-scale-for-keyboard-focus-with-author-defined-scale.html: Added.
        * fast/forms/ios/user-scalable-does-not-scale-for-keyboard-focus-with-user-scalable-no-expected.txt: Added.
        * fast/forms/ios/user-scalable-does-not-scale-for-keyboard-focus-with-user-scalable-no.html: Added.
        * fast/forms/ios/user-scalable-scales-for-keyboard-focus-with-no-author-defined-scale-expected.txt: Added.
        * fast/forms/ios/user-scalable-scales-for-keyboard-focus-with-no-author-defined-scale.html: Added.
        * fast/viewport/ios/user-scalable-does-not-scale-for-keyboard-focus-with-author-defined-scale-expected.txt: Removed.
        * fast/viewport/ios/user-scalable-does-not-scale-for-keyboard-focus-with-author-defined-scale.html: Removed.
        * fast/viewport/ios/user-scalable-scales-for-keyboard-focus-with-no-author-defined-scale-expected.txt: Removed.
        * fast/viewport/ios/user-scalable-scales-for-keyboard-focus-with-no-author-defined-scale.html: Removed.

2016-09-29  Chris Dumez  <cdumez@apple.com>

        [iOS] Update Touch constructor test to cover clientX / clientY attributes
        https://bugs.webkit.org/show_bug.cgi?id=162757

        Reviewed by Sam Weinig.

        Update Touch constructor test to cover clientX / clientY attributes.

        * fast/events/touch/touch-constructor.html:

2016-09-29  Chris Dumez  <cdumez@apple.com>

        [iOS] Add test for Touch constructor
        https://bugs.webkit.org/show_bug.cgi?id=162736
        <rdar://problem/28520007>

        Reviewed by Ryosuke Niwa.

        Add test for Touch constructor. There are no expected results because
        the test (folder) is skipped in the open source.

        * fast/events/touch/touch-constructor.html: Added.

2016-09-28  Ada Chan  <adachan@apple.com>

        Fix flaky test media/click-placeholder-not-pausing.html
        https://bugs.webkit.org/show_bug.cgi?id=162661

        Reviewed by Eric Carlson.

        This test became flaky after r201474 when we started to delay showing
        the inline placeholder until we are sure the video layer has been moved
        into the video fullscreen layer. This means we can't guarantee that the
        placeholder is visible right away after the video's presentation mode
        changes to "picture-in-picture".

        To fix this, wait for the placeholder to become visible before clicking it.

        * media/click-placeholder-not-pausing.html:
        * platform/mac-wk2/TestExpectations:

2016-09-29  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r206483.
        https://bugs.webkit.org/show_bug.cgi?id=162750

        May have caused iOS perf regression (Requested by smfr on
        #webkit).

        Reverted changeset:

        "REGRESSION (r204552): Yelp carousel animation is not smooth."
        https://bugs.webkit.org/show_bug.cgi?id=162632
        http://trac.webkit.org/changeset/206483

2016-09-29  Ryan Haddad  <ryanhaddad@apple.com>

        Removing El Capitan modifier from flaky test media/restore-from-page-cache.html.
        https://bugs.webkit.org/show_bug.cgi?id=158747

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2016-09-29  Antoine Quint  <graouts@apple.com>

        [Modern Media Controls] scheduler for layout nodes
        https://bugs.webkit.org/show_bug.cgi?id=162726
        <rdar://problem/28543043>

        Reviewed by Dean Jackson.

        Testing the basic functionality for the LayoutNode scheduler.

        * media/modern-media-controls/scheduler/not-reentrant-expected.txt: Added.
        * media/modern-media-controls/scheduler/not-reentrant.html: Added.
        * media/modern-media-controls/scheduler/single-callback-when-registered-multiple-times-expected.txt: Added.
        * media/modern-media-controls/scheduler/single-callback-when-registered-multiple-times.html: Added.

2016-09-28  Ryosuke Niwa  <rniwa@webkit.org>

        Text nodes assigned to a linked slot are not clickable
        https://bugs.webkit.org/show_bug.cgi?id=162091
        <rdar://problem/28383300>

        Reviewed by Antti Koivisto.

        Added a regression test for clicking inside a text node assigned to a slot inside a hyperlink.

        Unfortunately, there is not a way to make this a W3C style test until the web platform tests
        start supporting WebDriver.

        * fast/shadow-dom/click-text-inside-linked-slot-expected.txt: Added.
        * fast/shadow-dom/click-text-inside-linked-slot.html: Added.
        * platform/ios-simulator-wk2/TestExpectations:

2016-09-29  Ryan Haddad  <ryanhaddad@apple.com>

        Marking fast/images/load-img-with-empty-src.html as crashing.
        https://bugs.webkit.org/show_bug.cgi?id=162696

        Unreviewed test gardening.

        * TestExpectations:

2016-09-29  Ryan Haddad  <ryanhaddad@apple.com>

        Marking fast/images/pdf-as-image-with-annotations.html as crashing.
        https://bugs.webkit.org/show_bug.cgi?id=162696

        Unreviewed test gardening.

        * TestExpectations:

2016-09-29  Saam Barati  <sbarati@apple.com>

        parser-syntax-check should display the output of syntax errors
        https://bugs.webkit.org/show_bug.cgi?id=162738

        Reviewed by Joseph Pecoraro.

        It's good to have this test display the syntax error messages
        when we're expecting a syntax error because it will both allow
        us to track changes in error messages and verify that we get
        the expected error message when writing new tests.

        * js/parser-syntax-check-expected.txt:
        * js/script-tests/parser-syntax-check.js:
        (runTest):

2016-09-29  Simon Fraser  <simon.fraser@apple.com>

        Fix hit testing on display:block <svg> elements
        https://bugs.webkit.org/show_bug.cgi?id=162717
        rdar://problem/23261130

        Reviewed by Zalan Bujtas.
        
        Test hit testing on inline and block <svg> elements.

        * svg/hittest/block-svg-expected.txt: Added.
        * svg/hittest/block-svg.html: Added.

2016-09-29  Saam Barati  <sbarati@apple.com>

        We don't properly propagate non-simple-parameter-list when parsing a setter
        https://bugs.webkit.org/show_bug.cgi?id=160483

        Reviewed by Joseph Pecoraro.

        * js/parser-syntax-check-expected.txt:
        * js/script-tests/parser-syntax-check.js:

2016-09-29  Nan Wang  <n_wang@apple.com>

        AX: Meter: [Mac] Content in label element should be used as AXTitle or AXDescription
        https://bugs.webkit.org/show_bug.cgi?id=162586

        Reviewed by Chris Fleizach.

        * accessibility/mac/aria-label-on-label-element-expected.txt:
        * accessibility/mac/aria-label-on-label-element.html:
        * accessibility/mac/meter-with-label-element-expected.txt: Added.
        * accessibility/mac/meter-with-label-element.html: Added.

2016-09-28  Chris Dumez  <cdumez@apple.com>

        Import touch-events web-platform-tests
        https://bugs.webkit.org/show_bug.cgi?id=162713

        Reviewed by Alex Christensen.

        Skip on all platforms that do not have Touch enabled.

        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:
        * platform/win/TestExpectations:

2016-09-28  Ryan Haddad  <ryanhaddad@apple.com>

        Marking fast/images/object-image.html as crashing.
        https://bugs.webkit.org/show_bug.cgi?id=162696

        Unreviewed test gardening.

        * TestExpectations:

2016-09-28  Chris Dumez  <cdumez@apple.com>

        Log console messages when the anchor download attribute is ignored
        https://bugs.webkit.org/show_bug.cgi?id=162703

        Reviewed by Alex Christensen.

        Log console messages when the anchor download attribute is ignored so
        that the developer can better understand what's happening.

        * fast/dom/HTMLAnchorElement/anchor-download-synthetic-click-expected.txt:
        * http/tests/security/anchor-download-block-crossorigin-expected.txt:

2016-09-28  Chris Dumez  <cdumez@apple.com>

        Add support for DOMTokenList.supports()
        https://bugs.webkit.org/show_bug.cgi?id=162659

        Reviewed by Ryosuke Niwa.

        Add layout test coverage. Our pass rate is identical to Firefox 49,
        everything passes except HTMLElement.dropzone. Chrome 53's pass rate
        is lower because relList is not a DOMTokenList on anchor / area,
        they do not support HTMLElement.dropzone and their
        DOMTokenList.supports() is case-sensitive.

        * fast/dom/DOMTokenList-supports-expected.txt: Added.
        * fast/dom/DOMTokenList-supports.html: Added.

2016-09-28  Ryosuke Niwa  <rniwa@webkit.org>

        DOMTokenList’s value and stringifier should not return parsed tokens
        https://bugs.webkit.org/show_bug.cgi?id=161076

        Reviewed by Chris Dumez.

        Added more test cases and rebaselined tests. Most of changes are due to the change that DOMTokenList's value
        and stringifier now returns the original attribute value with extra whitespaces.

        * fast/dom/HTMLLinkElement/sizes-setter-expected.txt:
        * fast/dom/HTMLLinkElement/sizes-setter.html:
        * fast/dom/HTMLOutputElement/dom-settable-token-list-expected.txt:
        * fast/dom/HTMLOutputElement/htmloutputelement-expected.txt:
        * fast/dom/HTMLOutputElement/htmloutputelement.html:
        * fast/dom/HTMLOutputElement/script-tests/dom-settable-token-list.js:
        * fast/frames/sandbox-attribute-expected.txt:
        * fast/frames/sandbox-attribute.html:

2016-09-28  Ryan Haddad  <ryanhaddad@apple.com>

        Marking fast/images/animated-gif-restored-from-bfcache.html as flaky on mac-wk2 debug.
        https://bugs.webkit.org/show_bug.cgi?id=162510

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2016-09-28  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/images/pdf-as-image-too-big.html as crashing.
        https://bugs.webkit.org/show_bug.cgi?id=162696

        Unreviewed test gardening.

        * TestExpectations:

2016-09-28  Ryan Haddad  <ryanhaddad@apple.com>

        Update TestExpectations for more crashing fast/images tests.
        https://bugs.webkit.org/show_bug.cgi?id=162696

        Unreviewed test gardening.

        * TestExpectations:

2016-09-28  Chris Dumez  <cdumez@apple.com>

        It should be possible to dispatch events on template documents
        https://bugs.webkit.org/show_bug.cgi?id=162687

        Reviewed by Ryosuke Niwa.

        Add layout test coverage.

        * fast/dom/template-document-dispatchEvent-expected.txt: Added.
        * fast/dom/template-document-dispatchEvent.html: Added.

2016-09-28  Ryan Haddad  <ryanhaddad@apple.com>

        Update TestExpectations for crashing fast/images tests.
        https://bugs.webkit.org/show_bug.cgi?id=162696

        Unreviewed test gardening.

        * TestExpectations:

2016-09-28  Ryan Haddad  <ryanhaddad@apple.com>

        Marking http/tests/cache/disk-cache/disk-cache-redirect.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=162524

        Unreviewed test gardening.

        * platform/ios-simulator-wk2/TestExpectations:
        * platform/mac-wk2/TestExpectations:

2016-09-28  Youenn Fablet  <youenn@apple.com>

        WebCore::ResourceErrorBase::setType is crashing
        https://bugs.webkit.org/show_bug.cgi?id=162484
        <rdar://problem/28390828>

        Reviewed by Alex Christensen.

        * http/tests/xmlhttprequest/on-network-timeout-error-during-preflight-expected.txt: Added.
        * http/tests/xmlhttprequest/on-network-timeout-error-during-preflight.html: Added.
        * tests-options.json: Marking test as slow.

2016-09-28  Jer Noble  <jer.noble@apple.com>

        [MSE][Mac] In SourceBufferPrivateAVFObjC::abort(), support reseting parser to the last appended initialization segment.
        https://bugs.webkit.org/show_bug.cgi?id=135164

        Reviewed by Eric Carlson.

        * media/media-source/media-source-abort-resets-parser-expected.txt: Added.
        * media/media-source/media-source-abort-resets-parser.html: Added.

2016-09-28  Alejandro G. Castro  <alex@igalia.com>

        Add WebIDL special operation support: serializer
        https://bugs.webkit.org/show_bug.cgi?id=156293

        Reviewed by Youenn Fablet.

        Verify the new API of the objects and check what happens when user
        modifies the values and types of the attributes, or adds a null value.

        * fast/mediastream/RTCIceCandidate-expected.txt:
        * fast/mediastream/RTCIceCandidate.html:
        * fast/mediastream/RTCSessionDescription-expected.txt:
        * fast/mediastream/RTCSessionDescription.html:

2016-09-28  Khaled Hosny  <khaledhosny@eglug.org>

        Use new woff2 API
        https://bugs.webkit.org/show_bug.cgi?id=162608

        Reviewed by Michael Catanzaro.

        * fast/text/resources/header-totalsfntsize-001.ttf: Added.
        * fast/text/resources/header-totalsfntsize-001.woff2: Added.
        * fast/text/woff2-totalsfntsize-expected.html: Added.
        * fast/text/woff2-totalsfntsize.html: Added.
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:
        * platform/win/TestExpectations:

2016-09-27  Nan Wang  <n_wang@apple.com>

        AX: CrashTracer: com.apple.WebKit.WebContent at WebCore::AXObjectCache::localCaretRectForCharacterOffset(WebCore::RenderObject*&, WebCore::CharacterOffset const&) + 116
        https://bugs.webkit.org/show_bug.cgi?id=162654

        Reviewed by Chris Fleizach.

        * accessibility/mac/bounds-for-range-crash-expected.txt: Added.
        * accessibility/mac/bounds-for-range-crash.html: Added.

2016-09-27  Ryosuke Niwa  <rniwa@webkit.org>

        Toggling display: none on a parent element of a slot which shares style with its parent doesn't update the slot's visibility
        https://bugs.webkit.org/show_bug.cgi?id=158421

        Reviewed by Darin Adler.

        Add a regression test now that the bug has been fixed by r206403.

        * fast/shadow-dom/shadow-layout-after-toggling-display-slot-parent-expected.html: Added.
        * fast/shadow-dom/shadow-layout-after-toggling-display-slot-parent.html: Added.

2016-09-27  Chris Dumez  <cdumez@apple.com>

        [iOS] Fix several Touch-related layout tests
        https://bugs.webkit.org/show_bug.cgi?id=162651

        Reviewed by Darin Adler.

        Fix several Touch-related layout tests. The first parameter to our Touch
        constructor must be a Window but several of our tests were passing in a
        Document.

        * platform/ios-simulator/ios/touch/construct-Touch-expected.txt:
        * platform/ios-simulator/ios/touch/resources/construct-Touch.js:
        * platform/ios-simulator/ios/touch/resources/construct-TouchList.js:

2016-09-27  Zalan Bujtas  <zalan@apple.com>

        REGRESSION (r204552): Yelp carousel animation is not smooth.
        https://bugs.webkit.org/show_bug.cgi?id=162632

        Reviewed by Simon Fraser.

        * compositing/hidpi-composited-container-and-graphics-layer-gap-changes-expected.html: Added.
        * compositing/hidpi-composited-container-and-graphics-layer-gap-changes.html: Added.
        * compositing/hidpi-negative-composited-bounds-on-device-pixel-expected.html: Added.
        * compositing/hidpi-negative-composited-bounds-on-device-pixel.html: Added.

2016-09-27  Chris Dumez  <cdumez@apple.com>

        <a download> does not honor the same-origin requirement
        https://bugs.webkit.org/show_bug.cgi?id=156100

        Reviewed by Alex Christensen.

        Update existing cross origin test as it expected the suggested filename to
        be ignored but the file to still be downloaded (Chrome behavior) instead
        of the download attribute to be completely ignored and therefore navigate
        (Firefox behavior).

        * TestExpectations:
        * http/tests/resources/pass-notify-done.html: Added.
        * http/tests/security/anchor-download-block-crossorigin-expected.txt:
        * http/tests/security/anchor-download-block-crossorigin.html:

2016-09-27  Ryan Haddad  <ryanhaddad@apple.com>

        Marking http/tests/xmlhttprequest/onabort-response-getters.html as failing on Sierra.
        https://bugs.webkit.org/show_bug.cgi?id=162647

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2016-09-27  Ryan Haddad  <ryanhaddad@apple.com>

        Marking imported/w3c/web-platform-tests/shadow-dom/scroll-to-the-fragment-in-shadow-tree.html as failing on ios-simulator-wk2.
        https://bugs.webkit.org/show_bug.cgi?id=162645

        Unreviewed test gardening.

        * platform/ios-simulator-wk2/TestExpectations:

2016-09-27  Chris Dumez  <cdumez@apple.com>

        It should be possible to dispatch events on documents created using DOMParser
        https://bugs.webkit.org/show_bug.cgi?id=26147

        Reviewed by Ryosuke Niwa.

        Add layout test coverage.

        * fast/dom/parsed-document-dispatchEvent-expected.txt: Added.
        * fast/dom/parsed-document-dispatchEvent.html: Added.

2016-09-27  Ryan Haddad  <ryanhaddad@apple.com>

        Marking fast/scrolling/rtl-scrollbars-alternate-iframe-body-dir-attr-does-not-update-scrollbar-placement.html as flaky on Sierra.
        https://bugs.webkit.org/show_bug.cgi?id=162638

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2016-09-27  Ryosuke Niwa  <rniwa@webkit.org>

        Import w3c shadow DOM tests and fix one assertion
        https://bugs.webkit.org/show_bug.cgi?id=162629

        Reviewed by Chris Dumez.

        Deleted the duplicated copies of tests in fast/shadow/ since this patch re-imports them via web-platform-tests.

        * fast/shadow-dom/Element-interface-attachShadow-expected.txt: Removed.
        * fast/shadow-dom/Node-prototype-cloneNode-expected.txt: Removed.

2016-09-27  Ryan Haddad  <ryanhaddad@apple.com>

        Marking imported/w3c/web-platform-tests/media-source/mediasource-liveseekable.html as flaky on mac.
        https://bugs.webkit.org/show_bug.cgi?id=162626

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2016-09-27  Chris Dumez  <cdumez@apple.com>

        Second parameter to MutationObserver.observe() should be optional
        https://bugs.webkit.org/show_bug.cgi?id=162627

        Reviewed by Ryosuke Niwa.

        Rebaseline existing test now that the exception messages are slightly
        different.

        * fast/dom/MutationObserver/observe-exceptions-expected.txt:

2016-09-27  Dan Bernstein  <mitz@apple.com>

        [iOS] REGRESSION (r182126): Selection highlight and handles aren’t visible with WKSelectionGranularityCharacter
        https://bugs.webkit.org/show_bug.cgi?id=162577
        <rdar://problem/28481984>

        Reviewed by Simon Fraser.

        * TestExpectations:
        * editing/selection/character-granularity-rect-expected.txt: Added.
        * editing/selection/character-granularity-rect.html: Added.
        * platform/ios-simulator-wk2/TestExpectations:

2016-09-27  Jer Noble  <jer.noble@apple.com>

        Remove deprecated ENCRYPTED_MEDIA implementation.
        https://bugs.webkit.org/show_bug.cgi?id=161010

        Reviewed by Eric Carlson.

        * fast/events/constructors/media-key-event-constructor-expected.txt: Removed.
        * fast/events/constructors/media-key-event-constructor.html: Removed.
        * media/encrypted-media/encrypted-media-can-play-type-expected.txt: Removed.
        * media/encrypted-media/encrypted-media-can-play-type-webm-expected.txt: Removed.
        * media/encrypted-media/encrypted-media-can-play-type-webm.html: Removed.
        * media/encrypted-media/encrypted-media-can-play-type.html: Removed.
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-yosemite/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/fast/events/constructors/media-key-event-constructor-expected.txt: Removed.
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2016-09-27  Chris Dumez  <cdumez@apple.com>

        [WK2] Navigating to a Blob URL does not trigger a download
        https://bugs.webkit.org/show_bug.cgi?id=162574

        Reviewed by Darin Adler.

        Rebaseline now that the suggested download name is "unknown" by default
        for blob downloads as well.

        * fast/dom/HTMLAnchorElement/anchor-download-expected.txt:
        * fast/dom/HTMLAnchorElement/anchor-nodownload-set-expected.txt:

2016-09-27  Myles C. Maxfield  <mmaxfield@apple.com>

        REGRESSION(r205883): Letterpressed text is invisible
        https://bugs.webkit.org/show_bug.cgi?id=162590

        Reviewed by Simon Fraser.

        Letterpress is only implemented on iOS, so letterpress-different.html is marked
        as only passing on iOS. letterpress-paint.html makes sure that letterpressed paint
        is not invisible.

        * TestExpectations:
        * fast/text/letterpress-different-expected-mismatch.html: Added.
        * fast/text/letterpress-different.html: Added.
        * fast/text/letterpress-paint-expected-mismatch.html: Added.
        * fast/text/letterpress-paint.html: Added.
        * platform/ios-simulator/TestExpectations:

2017-09-26  Ryan Haddad  <ryanhaddad@apple.com>

        Marking css3/filters/backdrop/backdrop-filter-with-reflection* tests as flaky on Sierra WK1.
        https://bugs.webkit.org/show_bug.cgi?id=162591

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2016-09-26  Ryan Haddad  <ryanhaddad@apple.com>

        Remove 100ms timeout for media/media-source/media-source-delaying-load-event.html to try to fix flakiness.
        https://bugs.webkit.org/show_bug.cgi?id=162566

        Reviewed by Alexey Proskuryakov.

        * media/media-source/media-source-delaying-load-event.html:

2016-09-26  Antti Koivisto  <antti@apple.com>

        Setter on style element's textContent or cssText doesn't trigger style recalc
        https://bugs.webkit.org/show_bug.cgi?id=160331
        <rdar://problem/27609715>

        Reviewed by Ryosuke Niwa and Daniel Bates.

        * fast/shadow-dom/shadow-style-text-mutation-expected.html: Added.
        * fast/shadow-dom/shadow-style-text-mutation.html: Added.

2016-09-26  Antti Koivisto  <antti@apple.com>

        Input elements don't work inside shadow tree
        https://bugs.webkit.org/show_bug.cgi?id=160427

        Reviewed by Darin Adler.

        * fast/shadow-dom/composed-tree-shadow-child-subtree-expected.txt: Added.
        * fast/shadow-dom/composed-tree-shadow-child-subtree.html: Added.
        * fast/shadow-dom/input-element-in-shadow-expected.html: Added.
        * fast/shadow-dom/input-element-in-shadow.html: Added.

2016-09-26  Ryan Haddad  <ryanhaddad@apple.com>

        Marking media/media-document-audio-repaint.html as flaky on Sierra.
        https://bugs.webkit.org/show_bug.cgi?id=155757

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2016-09-26  Chris Dumez  <cdumez@apple.com>

        [WK2] BlobDownloadClient should use asynchronous IPC to decide destination path
        https://bugs.webkit.org/show_bug.cgi?id=162568

        Reviewed by Alex Christensen.

        * fast/dom/HTMLAnchorElement/anchor-download-expected.txt:
        * fast/dom/HTMLAnchorElement/anchor-nodownload-set-expected.txt:
        * http/tests/security/anchor-download-allow-blob-expected.txt:
        Rebaseline several Blob download tests now that the "Download started"
        message always comes first (as it should).

        * platform/mac-wk2/TestExpectations:
        Unskip test that is no longer flaky.

2016-09-26  Nan Wang  <n_wang@apple.com>

        AX: Progress: [Mac] Content in label element should be used as AXTitle or AXDescription
        https://bugs.webkit.org/show_bug.cgi?id=162573

        Reviewed by Chris Fleizach.

        * accessibility/mac/progress-with-label-element-expected.txt: Added.
        * accessibility/mac/progress-with-label-element.html: Added.

2016-09-26  Ryan Haddad  <ryanhaddad@apple.com>

        Marking media/media-controls-drag-timeline-set-controls-property.html as flaky on Yosemite Debug WK2.
        https://bugs.webkit.org/show_bug.cgi?id=161659

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

== Rolled over to ChangeLog-2016-09-26 ==
